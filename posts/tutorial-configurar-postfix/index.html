<!DOCTYPE html><html lang="es" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Tutorial: Instalar y configurar servicio de email Postfix" /><meta property="og:locale" content="es" /><meta name="description" content="Instalar servidor DNS" /><meta property="og:description" content="Instalar servidor DNS" /><link rel="canonical" href="https://marcosruiz.github.io/posts/tutorial-configurar-postfix/" /><meta property="og:url" content="https://marcosruiz.github.io/posts/tutorial-configurar-postfix/" /><meta property="og:site_name" content="Marcos Ruiz" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-13T16:50:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Tutorial: Instalar y configurar servicio de email Postfix" /><meta name="twitter:site" content="@whataweekhuh" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-03T18:25:19+02:00","datePublished":"2022-02-13T16:50:00+01:00","description":"Instalar servidor DNS","headline":"Tutorial: Instalar y configurar servicio de email Postfix","mainEntityOfPage":{"@type":"WebPage","@id":"https://marcosruiz.github.io/posts/tutorial-configurar-postfix/"},"url":"https://marcosruiz.github.io/posts/tutorial-configurar-postfix/"}</script><title>Tutorial: Instalar y configurar servicio de email Postfix | Marcos Ruiz</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Marcos Ruiz"><meta name="application-name" content="Marcos Ruiz"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://avatars.githubusercontent.com/u/7647613?v=4 " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Marcos Ruiz</a></div><div class="site-subtitle font-italic">Trabaja duro para ser vago</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>INICIO</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORÍAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>ETIQUETAS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVOS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>SOBRE MÍ</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/marcosruiz" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['profesor.mruizg','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Inicio </a> </span> <span>Tutorial: Instalar y configurar servicio de email Postfix</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Artículo</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> </span> <span id="search-cancel" >Cancelar</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Tutorial: Instalar y configurar servicio de email Postfix</h1><div class="post-meta text-muted"><div> <em> <a href="https://github.com/marcosruiz">Marcos Ruiz</a> </em></div><div class="d-flex"><div> <span> <em class="timeago" data-ts="1644767400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-13 </em> </span> <span> Actualizado <em class="timeago" data-ts="1664814319" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-10-03 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3951 palabras"> <em>21 minutos</em> lectura</span></div></div></div><div class="post-content"><h2 id="instalar-servidor-dns"><span class="mr-2">Instalar servidor DNS</span><a href="#instalar-servidor-dns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h2 id="introducción"><span class="mr-2">Introducción</span><a href="#introducción" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Para la instalación del servidor DNS Bind9 se han seguido los pasos indicados en el siguiente vídeo:</p><iframe src="https://www.youtube.com/embed/hq8kWcpGUvw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>Para la instalación del servidor DNS Bind9 se han seguido los pasos indicados en el siguiente vídeo:</p><iframe src="https://www.youtube.com/embed/kWNyiZfTp4E" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><h2 id="instalación-y-configuración-del-servidor-dns-bind9"><span class="mr-2">Instalación y configuración del servidor DNS Bind9</span><a href="#instalación-y-configuración-del-servidor-dns-bind9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/tutorial-configurar-postfix/configuracionRedServidor.png" alt="img-description" data-proofer-ignore> <em>Configuración de red servidor DNS</em></p><p>Instalar programas necesarios:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo</span> <span class="nt">-i</span>
<span class="gp">#</span><span class="w"> </span>apt update
<span class="gp">#</span><span class="w"> </span>apt <span class="nb">install </span>bind9
<span class="gp">#</span><span class="w"> </span>apt <span class="nb">install </span>resolvconf
<span class="gp">#</span><span class="w"> </span>resolvconf <span class="nt">-u</span>
</pre></table></code></div></div><p>Ejecutamos la siguiente instrucción para tener permisos de administrador.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>service network-manager restart
<span class="gp">#</span><span class="w"> </span>ifconfig
<span class="gp">#</span><span class="w"> </span>ping google.es
<span class="gp">#</span><span class="w"> </span>ifconfig
<span class="gp">#</span><span class="w"> </span>service bind9 status
</pre></table></code></div></div><p>Comprobamos que el fichero resolv.conf está bien, sino reiniciamos la máquina:</p><div file="/etc/resolv.conf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/resolv.conf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)</span>
<span class="c">#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN</span>
<span class="c"># 127.0.0.53 is the systemd-resolved stub resolver.</span>
<span class="c"># run "systemd-resolve --status" to see details about the actual nameservers.</span>

nameserver 192.168.222.2
nameserver 127.0.0.53
search mruizg.es
</pre></table></code></div></div><p>Si aún así no se actualiza, modificamos el fichero head añadiendo el <code class="language-plaintext highlighter-rouge">nameserver</code>:</p><div file="/etc/resolvconf/resolv.conf.d/head" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/resolvconf/resolv.conf.d/head"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
# 127.0.0.53 is the systemd-resolved stub resolver.
# run "systemd-resolve --status" to see details about the actual nameservers.

nameserver 192.168.222.2
</pre></table></code></div></div><p>Modificamos esta línea del fichero nsswitch.conf:</p><div file="/etc/nsswitch.conf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/nsswitch.conf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hosts:          files mdns4_minimal <span class="o">[</span><span class="nv">NOTFOUND</span><span class="o">=</span><span class="k">return</span><span class="o">]</span> dns
</pre></table></code></div></div><p>Por esta:</p><div file="/etc/nsswitch.conf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/nsswitch.conf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hosts:          dns files mdns4_minimal <span class="o">[</span><span class="nv">NOTFOUND</span><span class="o">=</span><span class="k">return</span><span class="o">]</span>
</pre></table></code></div></div><p>En named.conf.local añadimos lo siguiente:</p><div file="/etc/bind/named.conf.local" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/bind/named.conf.local"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>// zona directa para el dominio mruizg.es
zone <span class="s2">"mruizg.es"</span> <span class="o">{</span>
  <span class="nb">type </span>master<span class="p">;</span>
  file <span class="s2">"/etc/bind/db.mruizg.es"</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
// zona inversa para la red 192.168.222.0
zone <span class="s2">"222.168.192.in-addr.arpa"</span> <span class="o">{</span>
  <span class="nb">type </span>master<span class="p">;</span>
  file <span class="s2">"/etc/bind/db.222.168.192"</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><div file="/etc/bind/db.mruizg.es" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/bind/db.mruizg.es"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="p">;</span>
<span class="p">;</span> BIND data file <span class="k">for </span>mruizg.es zone
<span class="p">;</span>
<span class="nv">$TTL</span>    604800
@       IN      SOA     servidor.mruizg.es. root.mruizg.es. <span class="o">(</span>
                              2         <span class="p">;</span> Serial
                         604800         <span class="p">;</span> Refresh
                          86400         <span class="p">;</span> Retry
                        2419200         <span class="p">;</span> Expire
                         604800 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
<span class="p">;</span>
<span class="p">;</span>
                       IN    NS       servidor.mruizg.es.
servidor               IN    A        192.168.222.2
cliente1               IN    A        192.168.222.51
router                 IN    A        192.168.222.1
cliente2.mruizg.es.    IN    A        192.168.222.52
server                 IN    CNAME    servidor
correo                 IN    A        192.168.222.2
mruizg.es.             IN    MX 10    correo
</pre></table></code></div></div><div file="/etc/bind/db.222.168.192" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/bind/db.222.168.192"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="p">;</span>
<span class="p">;</span> BIND data file <span class="k">for </span>mruizg.es zone
<span class="p">;</span>
<span class="nv">$TTL</span>    604800
@       IN      SOA     servidor.mruizg.es. root.mruizg.es. <span class="o">(</span>
                              2         <span class="p">;</span> Serial
                         604800         <span class="p">;</span> Refresh
                          86400         <span class="p">;</span> Retry
                        2419200         <span class="p">;</span> Expire
                         604800 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
<span class="p">;</span>
<span class="p">;</span>
      IN    NS     servidor.mruizg.es.
2     IN    PTR    servidor.mruizg.es.
51    IN    PTR    cliente1.mruizg.es.
1     IN    PTR    router.mruizg.es.
52    IN    PTR    cliente2.mruizg.es.
2     IN    PTR    correo.mruizg.es.
</pre></table></code></div></div><p>Comprobamos la sintaxis con los siguientes comandos:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>named-checkconf /etc/bind/named.conf.local
<span class="gp">#</span><span class="w"> </span>named-checkzone mruiz.es /etc/bind/db.mruizg.es
<span class="gp">#</span><span class="w"> </span>named-checkzone 222.168.192.in-addr.arpa /etc/bind/db.222.168.192
<span class="gp">#</span><span class="w"> </span>service bind9 restart
<span class="gp">#</span><span class="w"> </span>service bind9 status
</pre></table></code></div></div><p>Comprobamos que funciona:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>nslookup servidor
<span class="gp">#</span><span class="w"> </span>nslookup server
<span class="gp">#</span><span class="w"> </span>nslookup 192.168.222.2
<span class="gp">#</span><span class="w"> </span>nslookup correo.mruizg.es
</pre></table></code></div></div><p>Creamos los usuarios mruizgCompras y mruizVentas con la interfaz de usuario:</p><p><img data-src="/assets/img/tutorial-configurar-postfix/usuariosServidor.png" alt="img-description" data-proofer-ignore> <em>Usuarios mruizgCompras y mruizgVentas</em></p><h2 id="instalación-y-configuración-del-servidor-de-email-postfix"><span class="mr-2">Instalación y configuración del servidor de email Postfix</span><a href="#instalación-y-configuración-del-servidor-de-email-postfix" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>apt <span class="nb">install </span>postfix
</pre></table></code></div></div><p><img data-src="/assets/img/tutorial-configurar-postfix/postfix1.png" alt="img-description" data-proofer-ignore> <em>Instalación de Postfix: Postfix Configuration (Parte 1)</em></p><p><img data-src="/assets/img/tutorial-configurar-postfix/postfix2.png" alt="img-description" data-proofer-ignore> <em>Instalación de Postfix: Postfix Configuration (Parte 2)</em></p><p>Comprobamos la versión</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>postconf mail_version
<span class="go">mail_version = 3.3.0
</span></pre></table></code></div></div><p>Comprobamos que el servicio está escuchando por el puerto 25:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>netstat <span class="nt">-lnpt</span>
<span class="go">Conexiones activas de Internet (solo servidores)
Proto  Recib Enviad Dirección local         Dirección remota       Estado       PID/Program name    
tcp        0      0 192.168.222.2:53        0.0.0.0:*               ESCUCHAR    3103/named          
tcp        0      0 127.0.0.1:53            0.0.0.0:*               ESCUCHAR    3103/named          
tcp        0      0 127.0.0.53:53           0.0.0.0:*               ESCUCHAR    536/systemd-resolve 
tcp        0      0 127.0.0.1:631           0.0.0.0:*               ESCUCHAR    562/cupsd           
tcp        0      0 0.0.0.0:25              0.0.0.0:*               ESCUCHAR    4957/master         
tcp        0      0 127.0.0.1:953           0.0.0.0:*               ESCUCHAR    3103/named          
tcp6       0      0 :::53                   :::*                    ESCUCHAR    3103/named          
tcp6       0      0 ::1:631                 :::*                    ESCUCHAR    562/cupsd           
tcp6       0      0 :::25                   :::*                    ESCUCHAR    4957/master         
tcp6       0      0 ::1:953                 :::*                    ESCUCHAR    3103/named  
</span></pre></table></code></div></div><p>Comprobamos si el cortafuegos nos está bloqueando el puerto 25 (de entrada) desde una máquina cliente:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nc <span class="nt">-zv</span> 192.168.222.2 25
<span class="go">Connection to 192.168.222.2 25 port [tcp/smtp] succeeded!
</span></pre></table></code></div></div><p>Comprobamos si el cortafuegos nos está bloqueando el puerto 25 (de salida) desde el servidor:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>telnet gmail-smtp-in.l.google.com 25
<span class="go">Trying 173.194.76.26...
Connected to gmail-smtp-in.l.google.com.
Escape character is '^]'.
220 mx.google.com ESMTP c8si11219209wri.907 - gsmtp
</span></pre></table></code></div></div><p>Escribimos <code class="language-plaintext highlighter-rouge">quit</code> para salir.</p><p>Comprobamos la carpeta donde se encuentran todos los ficheros de configuración. El fichero que nos interesa es el main.cf:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span> /etc/postfix
<span class="go">total 128
-rw-r--r-- 1 root root    60 feb 13 20:49 dynamicmaps.cf
drwxr-xr-x 2 root root  4096 ago 12  2021 dynamicmaps.cf.d
-rw-r--r-- 1 root root  1503 feb 13 20:49 main.cf
-rw-r--r-- 1 root root 27125 feb 13 20:49 main.cf.proto
-rw-r--r-- 1 root root  4480 ago 12  2021 makedefs.out
-rw-r--r-- 1 root root  6143 feb 13 20:49 master.cf
-rw-r--r-- 1 root root  6143 feb 13 20:49 master.cf.proto
-rw-r--r-- 1 root root 10170 ago 12  2021 postfix-files
drwxr-xr-x 2 root root  4096 ago 12  2021 postfix-files.d
-rwxr-xr-x 1 root root 10123 ago 12  2021 postfix-script
-rwxr-xr-x 1 root root 29522 ago 12  2021 post-install
drwxr-xr-x 2 root root  4096 ago 12  2021 sasl
</span></pre></table></code></div></div><p>Hacemos una copia de seguridad del archivo main.cf:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">cp /etc/postfix/main.cf /etc/postfix/main.cf.original
</span></pre></table></code></div></div><p>El archivo original es el siguiente:</p><div file="/etc/postfix/main.cf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/postfix/main.cf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="c"># Debian specific:  Specifying a file name will cause the first</span>
<span class="c"># line of that file to be used as the name.  The Debian default</span>
<span class="c"># is /etc/mailname.</span>
<span class="c">#myorigin = /etc/mailname</span>

smtpd_banner <span class="o">=</span> <span class="nv">$myhostname</span> ESMTP <span class="nv">$mail_name</span> <span class="o">(</span>Ubuntu<span class="o">)</span>
biff <span class="o">=</span> no

<span class="c"># appending .domain is the MUA's job.</span>
append_dot_mydomain <span class="o">=</span> no

<span class="c"># Uncomment the next line to generate "delayed mail" warnings</span>
<span class="c">#delay_warning_time = 4h</span>

readme_directory <span class="o">=</span> no

<span class="c"># See http://www.postfix.org/COMPATIBILITY_README.html -- default to 2 on</span>
<span class="c"># fresh installs.</span>
compatibility_level <span class="o">=</span> 2

<span class="c"># TLS parameters</span>
<span class="nv">smtpd_tls_cert_file</span><span class="o">=</span>/etc/ssl/certs/ssl-cert-snakeoil.pem
<span class="nv">smtpd_tls_key_file</span><span class="o">=</span>/etc/ssl/private/ssl-cert-snakeoil.key
<span class="nv">smtpd_use_tls</span><span class="o">=</span><span class="nb">yes
</span>smtpd_tls_session_cache_database <span class="o">=</span> btree:<span class="k">${</span><span class="nv">data_directory</span><span class="k">}</span>/smtpd_scache
smtp_tls_session_cache_database <span class="o">=</span> btree:<span class="k">${</span><span class="nv">data_directory</span><span class="k">}</span>/smtp_scache

<span class="c"># See /usr/share/doc/postfix/TLS_README.gz in the postfix-doc package for</span>
<span class="c"># information on enabling SSL in the smtp client.</span>

smtpd_relay_restrictions <span class="o">=</span> permit_mynetworks permit_sasl_authenticated defer_unauth_destination
myhostname <span class="o">=</span> smr-VirtualBox.mruizg.es
alias_maps <span class="o">=</span> <span class="nb">hash</span>:/etc/aliases
alias_database <span class="o">=</span> <span class="nb">hash</span>:/etc/aliases
myorigin <span class="o">=</span> /etc/mailname
mydestination <span class="o">=</span> <span class="nv">$myhostname</span>, mruizg.es, smr-VirtualBox, localhost.localdomain, localhost
</pre></table></code></div></div><p>Modificamos el fichero main.cf y lo dejamos de la siguiente manera:</p><div file="/etc/postfix/main.cf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/postfix/main.cf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c"># Debian specific:  Specifying a file name will cause the first</span>
<span class="c"># line of that file to be used as the name.  The Debian default</span>
<span class="c"># is /etc/mailname.</span>
<span class="c">#myorigin = /etc/mailname</span>

smtpd_banner <span class="o">=</span> <span class="nv">$myhostname</span> ESMTP <span class="nv">$mail_name</span> <span class="o">(</span>Ubuntu<span class="o">)</span>
biff <span class="o">=</span> no

<span class="c"># appending .domain is the MUA's job.</span>
append_dot_mydomain <span class="o">=</span> no

<span class="c"># Uncomment the next line to generate "delayed mail" warnings</span>
<span class="c">#delay_warning_time = 4h</span>

readme_directory <span class="o">=</span> no

<span class="c"># See http://www.postfix.org/COMPATIBILITY_README.html -- default to 2 on</span>
<span class="c"># fresh installs.</span>
compatibility_level <span class="o">=</span> 2

<span class="c"># TLS parameters</span>
<span class="nv">smtpd_tls_cert_file</span><span class="o">=</span>/etc/ssl/certs/ssl-cert-snakeoil.pem
<span class="nv">smtpd_tls_key_file</span><span class="o">=</span>/etc/ssl/private/ssl-cert-snakeoil.key
<span class="nv">smtpd_use_tls</span><span class="o">=</span><span class="nb">yes
</span>smtpd_tls_session_cache_database <span class="o">=</span> btree:<span class="k">${</span><span class="nv">data_directory</span><span class="k">}</span>/smtpd_scache
smtp_tls_session_cache_database <span class="o">=</span> btree:<span class="k">${</span><span class="nv">data_directory</span><span class="k">}</span>/smtp_scache

<span class="c"># See /usr/share/doc/postfix/TLS_README.gz in the postfix-doc package for</span>
<span class="c"># information on enabling SSL in the smtp client.</span>

smtpd_relay_restrictions <span class="o">=</span> permit_mynetworks permit_sasl_authenticated defer_unauth_destination
myhostname <span class="o">=</span> correo.mruizg.es
alias_maps <span class="o">=</span> <span class="nb">hash</span>:/etc/aliases
alias_database <span class="o">=</span> <span class="nb">hash</span>:/etc/aliases
myorigin <span class="o">=</span> /etc/mailname
mydestination <span class="o">=</span> <span class="nv">$myhostname</span>, mruizg.es, localhost.localdomain, localhost

<span class="c"># Añadido por mruizg</span>
mynetworks <span class="o">=</span> 192.168.222.0/24 127.0.0.0/8 <span class="o">[</span>::ffff:127.0.0.0]/104 <span class="o">[</span>::1]/128
inet_interfaces <span class="o">=</span> all

</pre></table></code></div></div><p>Comprobamos el fichero mailname contiene el nombre de dominio que tenemos:</p><div file="/etc/mailname" class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/mailname"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">mruizg.es
</span></pre></table></code></div></div><p>Actualizamos el servicio:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>service postfix reload
<span class="gp">#</span><span class="w"> </span>service postfix status
</pre></table></code></div></div><p>Comprobamos la configuración activa de Postfix:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>postconf <span class="nt">-n</span>
<span class="go">alias_database = hash:/etc/aliases
alias_maps = hash:/etc/aliases
append_dot_mydomain = no
biff = no
compatibility_level = 2
inet_interfaces = all
</span><span class="gp">mydestination = $</span>myhostname, mruizg.es, localhost.localdomain, localhost
<span class="go">myhostname = correo.mruizg.es
mynetworks = 192.168.222.0/24 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128
myorigin = /etc/mailname
readme_directory = no
</span><span class="gp">smtp_tls_session_cache_database = btree:$</span><span class="o">{</span>data_directory<span class="o">}</span>/smtp_scache
<span class="gp">smtpd_banner = $</span>myhostname ESMTP <span class="nv">$mail_name</span> <span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="go">smtpd_relay_restrictions = permit_mynetworks permit_sasl_authenticated defer_unauth_destination
smtpd_tls_cert_file = /etc/ssl/certs/ssl-cert-snakeoil.pem
smtpd_tls_key_file = /etc/ssl/private/ssl-cert-snakeoil.key
</span><span class="gp">smtpd_tls_session_cache_database = btree:$</span><span class="o">{</span>data_directory<span class="o">}</span>/smtpd_scache
<span class="go">smtpd_use_tls = yes
</span></pre></table></code></div></div><p>A partir de este momento ya deberiamos ser capaces de enviar y recibir correos.</p><h2 id="enviar-correos-desde-línea-de-comandos"><span class="mr-2">Enviar correos desde línea de comandos</span><a href="#enviar-correos-desde-línea-de-comandos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"correo de prueba de mruizg"</span> | sendmail mruizgCompras@mruizg.es
</pre></table></code></div></div><p>En otra terminal podemos tener los logs para comprobar que todo va bien:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">tail</span> <span class="nt">-f</span> /var/log/mail.log 
</pre></table></code></div></div><p>Y comprobamos los logs nuevos:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">Feb 13 21:19:54 smr-VirtualBox postfix/pickup[5981]: 38CAD456B6: uid=0 from=&lt;root&gt;</span><span class="w">
</span><span class="gp">Feb 13 21:19:54 smr-VirtualBox postfix/cleanup[6083]: 38CAD456B6: message-id=&lt;20220213201954.38CAD456B6@correo.mruizg.es&gt;</span><span class="w">
</span><span class="gp">Feb 13 21:19:54 smr-VirtualBox postfix/qmgr[5982]: 38CAD456B6: from=&lt;root@mruizg.es&gt;</span>, <span class="nv">size</span><span class="o">=</span>273, <span class="nv">nrcpt</span><span class="o">=</span>1 <span class="o">(</span>queue active<span class="o">)</span>
<span class="gp">Feb 13 21:19:54 smr-VirtualBox postfix/local[6085]: 38CAD456B6: to=&lt;mruizgCompras@mruizg.es&gt;</span>, <span class="nv">relay</span><span class="o">=</span><span class="nb">local</span>, <span class="nv">delay</span><span class="o">=</span>0.02, <span class="nv">delays</span><span class="o">=</span>0.01/0/0/0, <span class="nv">dsn</span><span class="o">=</span>2.0.0, <span class="nv">status</span><span class="o">=</span>sent <span class="o">(</span>delivered to mailbox<span class="o">)</span>
<span class="go">Feb 13 21:19:54 smr-VirtualBox postfix/qmgr[5982]: 38CAD456B6: removed
</span></pre></table></code></div></div><h2 id="mailbox"><span class="mr-2">Mailbox</span><a href="#mailbox" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Comprobamos la carpeta de Mailbox:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>postconf mail_spool_directory
<span class="go">mail_spool_directory = /var/mail
</span></pre></table></code></div></div><p>Comprobamos que ha llegado el correo en /var/mail/:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">cat</span> /var/mail/mruizgcompras 
<span class="go">From root@mruizg.es  Sun Feb 13 21:19:54 2022
</span><span class="gp">Return-Path: &lt;root@mruizg.es&gt;</span><span class="w">
</span><span class="go">X-Original-To: mruizgCompras@mruizg.es
Delivered-To: mruizgCompras@mruizg.es
Received: by correo.mruizg.es (Postfix, from userid 0)
</span><span class="gp">	id 38CAD456B6;</span><span class="w"> </span>Sun, 13 Feb 2022 21:19:54 +0100 <span class="o">(</span>CET<span class="o">)</span>
<span class="gp">Message-Id: &lt;20220213201954.38CAD456B6@correo.mruizg.es&gt;</span><span class="w">
</span><span class="go">Date: Sun, 13 Feb 2022 21:19:54 +0100 (CET)
</span><span class="gp">From: root &lt;root@mruizg.es&gt;</span><span class="w">
</span><span class="go">
correo de prueba de mruizg

</span></pre></table></code></div></div><p>Enviamos un segundo correo:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"correo 2 de prueba de mruizg"</span> | sendmail mruizgCompras@mruizg.es
</pre></table></code></div></div><p>Comprobamos que se apilan los mensajes:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">cat</span> /var/mail/mruizgcompras 
<span class="go">From root@mruizg.es  Sun Feb 13 21:19:54 2022
</span><span class="gp">Return-Path: &lt;root@mruizg.es&gt;</span><span class="w">
</span><span class="go">X-Original-To: mruizgCompras@mruizg.es
Delivered-To: mruizgCompras@mruizg.es
Received: by correo.mruizg.es (Postfix, from userid 0)
</span><span class="gp">	id 38CAD456B6;</span><span class="w"> </span>Sun, 13 Feb 2022 21:19:54 +0100 <span class="o">(</span>CET<span class="o">)</span>
<span class="gp">Message-Id: &lt;20220213201954.38CAD456B6@correo.mruizg.es&gt;</span><span class="w">
</span><span class="go">Date: Sun, 13 Feb 2022 21:19:54 +0100 (CET)
</span><span class="gp">From: root &lt;root@mruizg.es&gt;</span><span class="w">
</span><span class="go">
correo de prueba de mruizg

From root@mruizg.es  Sun Feb 13 21:25:02 2022
</span><span class="gp">Return-Path: &lt;root@mruizg.es&gt;</span><span class="w">
</span><span class="go">X-Original-To: mruizgCompras@mruizg.es
Delivered-To: mruizgCompras@mruizg.es
Received: by correo.mruizg.es (Postfix, from userid 0)
</span><span class="gp">	id AAEE8456B7;</span><span class="w"> </span>Sun, 13 Feb 2022 21:25:02 +0100 <span class="o">(</span>CET<span class="o">)</span>
<span class="gp">Message-Id: &lt;20220213202502.AAEE8456B7@correo.mruizg.es&gt;</span><span class="w">
</span><span class="go">Date: Sun, 13 Feb 2022 21:25:02 +0100 (CET)
</span><span class="gp">From: root &lt;root@mruizg.es&gt;</span><span class="w">
</span><span class="go">
correo 2 de prueba de mruizg

</span></pre></table></code></div></div><p>Envio un correo de prueba a mi correo externo:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>sendmail mruizg@chabacier.es
<span class="go">Subject: Prueba correo externo mruizg
Correo de prueba.
</span></pre></table></code></div></div><p>Pulsamos Ctrl+D para enviar y comprobamos los logs:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">Feb 13 21:28:47 smr-VirtualBox postfix/local[6120]: 34D20456BA: to=&lt;root@mruizg.es&gt;</span>, <span class="nv">relay</span><span class="o">=</span><span class="nb">local</span>, <span class="nv">delay</span><span class="o">=</span>0.01, <span class="nv">delays</span><span class="o">=</span>0.01/0/0/0, <span class="nv">dsn</span><span class="o">=</span>2.0.0, <span class="nv">status</span><span class="o">=</span>sent <span class="o">(</span>delivered to mailbox<span class="o">)</span>
<span class="go">Feb 13 21:28:47 smr-VirtualBox postfix/qmgr[5982]: 34D20456BA: removed
</span></pre></table></code></div></div><p>Vamos a nuestra cuenta de correo y comprobamos que se ha enviado bien. En este caso, no se envia bien ya que la IP pública que me ha asignado mi ISP está en la base de datos spamhaus.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Feb 13 22:40:17 smr-VirtualBox postfix/pickup[5981]: 24468456B9: <span class="nv">uid</span><span class="o">=</span>0 <span class="nv">from</span><span class="o">=</span>&lt;root&gt;
Feb 13 22:40:17 smr-VirtualBox postfix/cleanup[6331]: 24468456B9: message-id<span class="o">=</span>&lt;20220213214017.24468456B9@correo.mruizg.es&gt;
Feb 13 22:40:17 smr-VirtualBox postfix/qmgr[5982]: 24468456B9: <span class="nv">from</span><span class="o">=</span>&lt;root@mruizg.es&gt;, <span class="nv">size</span><span class="o">=</span>297, <span class="nv">nrcpt</span><span class="o">=</span>1 <span class="o">(</span>queue active<span class="o">)</span>
Feb 13 22:40:18 smr-VirtualBox postfix/smtp[6333]: 24468456B9: <span class="nv">to</span><span class="o">=</span>&lt;profesor.mruizg@gmail.com&gt;, <span class="nv">relay</span><span class="o">=</span>gmail-smtp-in.l.google.com[173.194.76.27]:25, <span class="nv">delay</span><span class="o">=</span>20, <span class="nv">delays</span><span class="o">=</span>19/0/0.74/0.26, <span class="nv">dsn</span><span class="o">=</span>5.7.1, <span class="nv">status</span><span class="o">=</span>bounced <span class="o">(</span>host gmail-smtp-in.l.google.com[173.194.76.27] said: 550-5.7.1 <span class="o">[</span>119.12.233.152] The IP you<span class="s1">'re using to send mail is not authorized to 550-5.7.1 send email directly to our servers. Please use the SMTP relay at your 550-5.7.1 service provider instead. Learn more at 550 5.7.1  https://support.google.com/mail/?p=NotAuthorizedError u15si10538713wrp.505 - gsmtp (in reply to end of DATA command))
Feb 13 22:40:18 smr-VirtualBox postfix/cleanup[6331]: 288D1456BA: message-id=&lt;20220213214018.288D1456BA@correo.mruizg.es&gt;
Feb 13 22:40:18 smr-VirtualBox postfix/bounce[6334]: 24468456B9: sender non-delivery notification: 288D1456BA
Feb 13 22:40:18 smr-VirtualBox postfix/qmgr[5982]: 288D1456BA: from=&lt;&gt;, size=2900, nrcpt=1 (queue active)
Feb 13 22:40:18 smr-VirtualBox postfix/qmgr[5982]: 24468456B9: removed
Feb 13 22:40:18 smr-VirtualBox postfix/local[6335]: 288D1456BA: to=&lt;root@mruizg.es&gt;, relay=local, delay=0.01, delays=0/0/0/0, dsn=2.0.0, status=sent (delivered to mailbox)
Feb 13 22:40:18 smr-VirtualBox postfix/qmgr[5982]: 288D1456BA: removed
</span></pre></table></code></div></div><p><img data-src="/assets/img/tutorial-configurar-postfix/spamhaus.png" alt="img-description" data-proofer-ignore> <em>IP bloqueada</em></p><p>Intentamos enviar un correo a root@mruizg.es y vemos que no funciona:</p><p><img data-src="/assets/img/tutorial-configurar-postfix/correoRespuestaFail.png" alt="img-description" data-proofer-ignore> <em>Mensaje de respuesta desde la cuenta del centro: No se ha encontrado la dirección</em></p><h2 id="maildir"><span class="mr-2">Maildir</span><a href="#maildir" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Añadimos al fichero main.cf la siguiente línea:</p><div file="/etc/postfix/main.cf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/postfix/main.cf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>home_mailbox <span class="o">=</span> Maildir/
</pre></table></code></div></div><p>Reiniciamos el servicio y comprobamos la configuración:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>service postfix restart
<span class="gp">#</span><span class="w"> </span>service postfix status
<span class="gp">#</span><span class="w"> </span>postconf <span class="nt">-n</span>
</pre></table></code></div></div><p>Instalamos el mailutils:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>apt <span class="nb">install </span>mailutils
</pre></table></code></div></div><p>Enviamos un mensaje:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"Subject: correo 3 de prueba de mruizg"</span> | sendmail mruizgCompras@mruizg.es
</pre></table></code></div></div><p>Y comprobamos en los logs que lo ha guardado en maildir (<code class="language-plaintext highlighter-rouge">delivered to maildir</code>):</p><div file="/var/log/mail.log" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/var/log/mail.log"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>Feb 13 22:59:06 smr-VirtualBox postfix/pickup[6598]: 001D6456C0: <span class="nv">uid</span><span class="o">=</span>0 <span class="nv">from</span><span class="o">=</span>&lt;root&gt;
Feb 13 22:59:06 smr-VirtualBox postfix/cleanup[7309]: 001D6456C0: message-id<span class="o">=</span>&lt;20220213215906.001D6456C0@correo.mruizg.es&gt;
Feb 13 22:59:06 smr-VirtualBox postfix/qmgr[6599]: 001D6456C0: <span class="nv">from</span><span class="o">=</span>&lt;root@mruizg.es&gt;, <span class="nv">size</span><span class="o">=</span>282, <span class="nv">nrcpt</span><span class="o">=</span>1 <span class="o">(</span>queue active<span class="o">)</span>
Feb 13 22:59:06 smr-VirtualBox postfix/local[7311]: 001D6456C0: <span class="nv">to</span><span class="o">=</span>&lt;mruizgCompras@mruizg.es&gt;, <span class="nv">relay</span><span class="o">=</span><span class="nb">local</span>, <span class="nv">delay</span><span class="o">=</span>0.02, <span class="nv">delays</span><span class="o">=</span>0.01/0/0/0, <span class="nv">dsn</span><span class="o">=</span>2.0.0, <span class="nv">status</span><span class="o">=</span>sent <span class="o">(</span>delivered to maildir<span class="o">)</span>
Feb 13 22:59:06 smr-VirtualBox postfix/qmgr[6599]: 001D6456C0: removed
</pre></table></code></div></div><p>Comprobamos que se han creado 3 carpetas en /home/mruizgcompras/Maildir/:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span> /home/mruizgcompras/Maildir/
<span class="go">total 12
drwx------ 2 mruizgcompras mruizgcompras 4096 feb 13 22:59 cur
drwx------ 2 mruizgcompras mruizgcompras 4096 feb 13 22:59 new
drwx------ 2 mruizgcompras mruizgcompras 4096 feb 13 22:59 tmp

</span></pre></table></code></div></div><p>Comprobamos que en la carpeta new tenemos un nuevo archivo:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">root@smr-VirtualBox:~#</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span> /home/mruizgcompras/Maildir/new/
<span class="go">total 4
-rw------- 1 mruizgcompras mruizgcompras 383 feb 13 22:59 1644789546.V801I1a6adfM8376.smr-VirtualBox

</span></pre></table></code></div></div><p>Y observamos el correo en sí:</p><div file="/home/mruizgcompras/Maildir/new/1644789546.V801I1a6adfM8376.smr-VirtualBox" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/home/mruizgcompras/Maildir/new/1644789546.V801I1a6adfM8376.smr-VirtualBox"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>Return-Path: &lt;root@mruizg.es&gt;
X-Original-To: mruizgCompras@mruizg.es
Delivered-To: mruizgCompras@mruizg.es
Received: by correo.mruizg.es <span class="o">(</span>Postfix, from userid 0<span class="o">)</span>
	<span class="nb">id </span>001D6456C0<span class="p">;</span> Sun, 13 Feb 2022 22:59:05 +0100 <span class="o">(</span>CET<span class="o">)</span>
Subject: correo 3 de prueba de mruizg
Message-Id: &lt;20220213215906.001D6456C0@correo.mruizg.es&gt;
Date: Sun, 13 Feb 2022 22:59:05 +0100 <span class="o">(</span>CET<span class="o">)</span>
From: root &lt;root@mruizg.es&gt;
</pre></table></code></div></div><p>Utilizamos el cliente de correo de mailutils:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>mail <span class="nt">-f</span> /home/mruizgcompras/Maildir/
<span class="go">"/home/mruizgcompras/Maildir/": 1 mensaje 1 nuevo
</span><span class="gp">&gt;</span>N   1 root                                 10/384   correo 3 de prueba de mruizg
<span class="go">? 1
</span><span class="gp">Return-Path: &lt;root@mruizg.es&gt;</span><span class="w">
</span><span class="go">X-Original-To: mruizgCompras@mruizg.es
Delivered-To: mruizgCompras@mruizg.es
Received: by correo.mruizg.es (Postfix, from userid 0)
</span><span class="gp">	id 001D6456C0;</span><span class="w"> </span>Sun, 13 Feb 2022 22:59:05 +0100 <span class="o">(</span>CET<span class="o">)</span>
<span class="go">Subject: correo 3 de prueba de mruizg
</span><span class="gp">Message-Id: &lt;20220213215906.001D6456C0@correo.mruizg.es&gt;</span><span class="w">
</span><span class="go">Date: Sun, 13 Feb 2022 22:59:05 +0100 (CET)
</span><span class="gp">From: root &lt;root@mruizg.es&gt;</span><span class="w">
</span></pre></table></code></div></div><p>En este momento podemos usar:</p><ul><li><code class="language-plaintext highlighter-rouge">q</code> para quitar<li><code class="language-plaintext highlighter-rouge">d</code> para elminar<li><code class="language-plaintext highlighter-rouge">h</code> para ver los correos</ul><p>Enviamos otro correo y comrpobamos que también llega:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"Subject: correo 4 de prueba de mruizg"</span> | sendmail mruizgCompras@mruizg.es
<span class="go">
</span><span class="gp">#</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span> /home/mruizgcompras/Maildir/new/
<span class="go">total 4
-rw------- 1 mruizgcompras mruizgcompras 383 feb 13 23:07 1644790031.V801I1a6ae2M655146.smr-VirtualBox

</span><span class="gp">#</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span> /home/mruizgcompras/Maildir/cur/
<span class="go">total 4
-rw------- 1 mruizgcompras mruizgcompras 383 feb 13 22:59 1644789546.V801I1a6adfM8376.smr-VirtualBox:2,RS

</span></pre></table></code></div></div><h2 id="instalación-y-configuración-de-dovecot"><span class="mr-2">Instalación y configuración de Dovecot</span><a href="#instalación-y-configuración-de-dovecot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Instalamos Dovecot y comprobamos su versión:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>apt <span class="nb">install </span>dovecot-core dovecot-imapd
<span class="gp">#</span><span class="w"> </span>dovecot <span class="nt">--version</span>
</pre></table></code></div></div><p>Hacemos una copia del archivo principal de configuración:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w">  </span><span class="nb">cp</span> /etc/dovecot/dovecot.conf /etc/dovecot/dovecot.conf.original
</pre></table></code></div></div><p>El archivo dovecot.conf original es el siguiente:</p><div file="/etc/dovecot/dovecot.conf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/dovecot/dovecot.conf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
</pre><td class="rouge-code"><pre><span class="c">## Dovecot configuration file</span>

<span class="c"># If you're in a hurry, see http://wiki2.dovecot.org/QuickConfiguration</span>

<span class="c"># "doveconf -n" command gives a clean output of the changed settings. Use it</span>
<span class="c"># instead of copy&amp;pasting files when posting to the Dovecot mailing list.</span>

<span class="c"># '#' character and everything after it is treated as comments. Extra spaces</span>
<span class="c"># and tabs are ignored. If you want to use either of these explicitly, put the</span>
<span class="c"># value inside quotes, eg.: key = "# char and trailing whitespace  "</span>

<span class="c"># Most (but not all) settings can be overridden by different protocols and/or</span>
<span class="c"># source/destination IPs by placing the settings inside sections, for example:</span>
<span class="c"># protocol imap { }, local 127.0.0.1 { }, remote 10.0.0.0/8 { }</span>

<span class="c"># Default values are shown for each setting, it's not required to uncomment</span>
<span class="c"># those. These are exceptions to this though: No sections (e.g. namespace {})</span>
<span class="c"># or plugin settings are added by default, they're listed only as examples.</span>
<span class="c"># Paths are also just examples with the real defaults being based on configure</span>
<span class="c"># options. The paths listed here are for configure --prefix=/usr</span>
<span class="c"># --sysconfdir=/etc --localstatedir=/var</span>

<span class="c"># Enable installed protocols</span>
<span class="o">!</span>include_try /usr/share/dovecot/protocols.d/<span class="k">*</span>.protocol

<span class="c"># A comma separated list of IPs or hosts where to listen in for connections. </span>
<span class="c"># "*" listens in all IPv4 interfaces, "::" listens in all IPv6 interfaces.</span>
<span class="c"># If you want to specify non-default ports or anything more complex,</span>
<span class="c"># edit conf.d/master.conf.</span>
<span class="c">#listen = *, ::</span>

<span class="c"># Base directory where to store runtime data.</span>
<span class="c">#base_dir = /var/run/dovecot/</span>

<span class="c"># Name of this instance. In multi-instance setup doveadm and other commands</span>
<span class="c"># can use -i &lt;instance_name&gt; to select which instance is used (an alternative</span>
<span class="c"># to -c &lt;config_path&gt;). The instance name is also added to Dovecot processes</span>
<span class="c"># in ps output.</span>
<span class="c">#instance_name = dovecot</span>

<span class="c"># Greeting message for clients.</span>
<span class="c">#login_greeting = Dovecot ready.</span>

<span class="c"># Space separated list of trusted network ranges. Connections from these</span>
<span class="c"># IPs are allowed to override their IP addresses and ports (for logging and</span>
<span class="c"># for authentication checks). disable_plaintext_auth is also ignored for</span>
<span class="c"># these networks. Typically you'd specify your IMAP proxy servers here.</span>
<span class="c">#login_trusted_networks =</span>

<span class="c"># Space separated list of login access check sockets (e.g. tcpwrap)</span>
<span class="c">#login_access_sockets = </span>

<span class="c"># With proxy_maybe=yes if proxy destination matches any of these IPs, don't do</span>
<span class="c"># proxying. This isn't necessary normally, but may be useful if the destination</span>
<span class="c"># IP is e.g. a load balancer's IP.</span>
<span class="c">#auth_proxy_self =</span>

<span class="c"># Show more verbose process titles (in ps). Currently shows user name and</span>
<span class="c"># IP address. Useful for seeing who are actually using the IMAP processes</span>
<span class="c"># (eg. shared mailboxes or if same uid is used for multiple accounts).</span>
<span class="c">#verbose_proctitle = no</span>

<span class="c"># Should all processes be killed when Dovecot master process shuts down.</span>
<span class="c"># Setting this to "no" means that Dovecot can be upgraded without</span>
<span class="c"># forcing existing client connections to close (although that could also be</span>
<span class="c"># a problem if the upgrade is e.g. because of a security fix).</span>
<span class="c">#shutdown_clients = yes</span>

<span class="c"># If non-zero, run mail commands via this many connections to doveadm server,</span>
<span class="c"># instead of running them directly in the same process.</span>
<span class="c">#doveadm_worker_count = 0</span>
<span class="c"># UNIX socket or host:port used for connecting to doveadm server</span>
<span class="c">#doveadm_socket_path = doveadm-server</span>

<span class="c"># Space separated list of environment variables that are preserved on Dovecot</span>
<span class="c"># startup and passed down to all of its child processes. You can also give</span>
<span class="c"># key=value pairs to always set specific settings.</span>
<span class="c">#import_environment = TZ</span>

<span class="c">##</span>
<span class="c">## Dictionary server settings</span>
<span class="c">##</span>

<span class="c"># Dictionary can be used to store key=value lists. This is used by several</span>
<span class="c"># plugins. The dictionary can be accessed either directly or though a</span>
<span class="c"># dictionary server. The following dict block maps dictionary names to URIs</span>
<span class="c"># when the server is used. These can then be referenced using URIs in format</span>
<span class="c"># "proxy::&lt;name&gt;".</span>

dict <span class="o">{</span>
  <span class="c">#quota = mysql:/etc/dovecot/dovecot-dict-sql.conf.ext</span>
  <span class="c">#expire = sqlite:/etc/dovecot/dovecot-dict-sql.conf.ext</span>
<span class="o">}</span>

<span class="c"># Most of the actual configuration gets included below. The filenames are</span>
<span class="c"># first sorted by their ASCII value and parsed in that order. The 00-prefixes</span>
<span class="c"># in filenames are intended to make it easier to understand the ordering.</span>
<span class="o">!</span>include conf.d/<span class="k">*</span>.conf

<span class="c"># A config file can also tried to be included without giving an error if</span>
<span class="c"># it's not found:</span>
<span class="o">!</span>include_try local.conf
</pre></table></code></div></div><p>La línea 24 con contenido <code class="language-plaintext highlighter-rouge">!include_try /usr/share/dovecot/protocols.d/*.protocol</code> nos indica el directorio donde se encuentran los protocolos instalados que están activos. En este caso solo tenemos el protocolo IMAP.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-l</span> /usr/share/dovecot/protocols.d/<span class="k">*</span>.protocol
<span class="go">-rw-r--r-- 1 root root 28 feb 13 23:10 /usr/share/dovecot/protocols.d/imapd.protocol
</span><span class="gp">#</span><span class="w"> </span><span class="nb">cat</span> /usr/share/dovecot/protocols.d/imapd.protocol
<span class="gp">protocols = $</span>protocols imap
</pre></table></code></div></div><p>Hacemos una copia de seguridad de los ficheros de configuración 10-ssl.conf, 10-auth.conf y 10-mail.conf:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span><span class="nb">cp</span> /etc/dovecot/conf.d/10-ssl.conf /etc/dovecot/conf.d/10-ssl.conf.original
<span class="gp">#</span><span class="w"> </span><span class="nb">cp</span> /etc/dovecot/conf.d/10-auth.conf /etc/dovecot/conf.d/10-auth.conf.original
<span class="gp">#</span><span class="w"> </span><span class="nb">cp</span> /etc/dovecot/conf.d/10-mail.conf /etc/dovecot/conf.d/10-mail.conf.original
</pre></table></code></div></div><p>El contenido original del fichero es el siguiente:</p><div file="/etc/dovecot/conf.d/10-ssl.conf" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/dovecot/conf.d/10-ssl.conf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="c">##</span>
<span class="c">## SSL settings</span>
<span class="c">##</span>

<span class="c"># SSL/TLS support: yes, no, required. &lt;doc/wiki/SSL.txt&gt;</span>
ssl <span class="o">=</span> <span class="nb">yes</span>

<span class="c"># PEM encoded X.509 SSL/TLS certificate and private key. They're opened before</span>
<span class="c"># dropping root privileges, so keep the key file unreadable by anyone but</span>
<span class="c"># root. Included doc/mkcert.sh can be used to easily generate self-signed</span>
<span class="c"># certificate, just make sure to update the domains in dovecot-openssl.cnf</span>
ssl_cert <span class="o">=</span> &lt;/etc/dovecot/private/dovecot.pem
ssl_key <span class="o">=</span> &lt;/etc/dovecot/private/dovecot.key

<span class="c"># If key file is password protected, give the password here. Alternatively</span>
<span class="c"># give it when starting dovecot with -p parameter. Since this file is often</span>
<span class="c"># world-readable, you may want to place this setting instead to a different</span>
<span class="c"># root owned 0600 file by using ssl_key_password = &lt;path.</span>
<span class="c">#ssl_key_password =</span>

<span class="c"># PEM encoded trusted certificate authority. Set this only if you intend to use</span>
<span class="c"># ssl_verify_client_cert=yes. The file should contain the CA certificate(s)</span>
<span class="c"># followed by the matching CRL(s). (e.g. ssl_ca = &lt;/etc/ssl/certs/ca.pem)</span>
<span class="c">#ssl_ca = </span>

<span class="c"># Require that CRL check succeeds for client certificates.</span>
<span class="c">#ssl_require_crl = yes</span>

<span class="c"># Directory and/or file for trusted SSL CA certificates. These are used only</span>
<span class="c"># when Dovecot needs to act as an SSL client (e.g. imapc backend). The</span>
<span class="c"># directory is usually /etc/ssl/certs in Debian-based systems and the file is</span>
<span class="c"># /etc/pki/tls/cert.pem in RedHat-based systems.</span>
ssl_client_ca_dir <span class="o">=</span> /etc/ssl/certs
<span class="c">#ssl_client_ca_file =</span>

<span class="c"># Request client to send a certificate. If you also want to require it, set</span>
<span class="c"># auth_ssl_require_client_cert=yes in auth section.</span>
<span class="c">#ssl_verify_client_cert = no</span>

<span class="c"># Which field from certificate to use for username. commonName and</span>
<span class="c"># x500UniqueIdentifier are the usual choices. You'll also need to set</span>
<span class="c"># auth_ssl_username_from_cert=yes.</span>
<span class="c">#ssl_cert_username_field = commonName</span>

<span class="c"># DH parameters length to use.</span>
<span class="c">#ssl_dh_parameters_length = 1024</span>

<span class="c"># SSL protocols to use</span>
<span class="c">#ssl_protocols = !SSLv3</span>

<span class="c"># SSL ciphers to use</span>
<span class="c">#ssl_cipher_list = ALL:!LOW:!SSLv2:!EXP:!aNULL</span>

<span class="c"># Prefer the server's order of ciphers over client's.</span>
<span class="c">#ssl_prefer_server_ciphers = no</span>

<span class="c"># SSL crypto device to use, for valid values run "openssl engine"</span>
<span class="c">#ssl_crypto_device =</span>

<span class="c"># SSL extra options. Currently supported options are:</span>
<span class="c">#   no_compression - Disable compression.</span>
<span class="c">#   no_ticket - Disable SSL session tickets.</span>
<span class="c">#ssl_options =</span>
</pre></table></code></div></div><p>Ponemos <code class="language-plaintext highlighter-rouge">ssl = no</code> y comentemos las siguientes dos líneas como se muestra a continuación:</p><div file="/etc/dovecot/conf.d/10-ssl.conf" class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="/etc/dovecot/conf.d/10-ssl.conf"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>ssl_cert <span class="o">=</span> &lt;/etc/dovecot/private/dovecot.pem
<span class="gp">#</span><span class="w"> </span>ssl_key <span class="o">=</span> &lt;/etc/dovecot/private/dovecot.key
</pre></table></code></div></div><p>Vamos a /etc/dovecot/conf.d/10-auth.conf y ponemos <code class="language-plaintext highlighter-rouge">disable_plaintext_auth = no</code>.</p><p>Descomentamos la línea <code class="language-plaintext highlighter-rouge">mail_location = maildir:~/Maildir</code> y comentamos <code class="language-plaintext highlighter-rouge"># mail_location = mbox:~/mail:INBOX=/var/mail/%u</code> para que Postfix y Dovecot tengan la misma configuración.</p><p>Reiniciamos el servicio:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>service dovecot restart
<span class="gp">#</span><span class="w"> </span>service dovecot status
</pre></table></code></div></div><p>Instalamos Thunderbird si no lo tenemos ya instalado:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>apt <span class="nb">install </span>thunderbird
</pre></table></code></div></div><p>Comprobamos que la configuración del cliente es la siguiente:</p><p><img data-src="/assets/img/tutorial-configurar-postfix/configuracionRedCliente.png" alt="img-description" data-proofer-ignore> <em>Configuración de red del cliente Zorin OS Lite</em></p><p>Hacemos un nslookup para comprobar la configuración del cliente:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copiado!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nslookup correo.mruizg.es
<span class="go">Server:		127.0.0.53
</span><span class="gp">Address:	127.0.0.53#</span>53
<span class="go">
Non-authoritative answer:
Name:	correo.mruizg.es
Address: 192.168.222.2
</span></pre></table></code></div></div><h2 id="thunderbird-en-el-servidor"><span class="mr-2">Thunderbird en el servidor</span><a href="#thunderbird-en-el-servidor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Añadimos el usuario y la contraseña y la configuración se autodetectará:</p><p><img data-src="/assets/img/tutorial-configurar-postfix/thunderbird1.png" alt="img-description" data-proofer-ignore> <em>Correo y contraseña en Thunderbird. Configuración autodetectada.</em></p><p><img data-src="/assets/img/tutorial-configurar-postfix/thunderbird1.png" alt="img-description" data-proofer-ignore> <em>Inbox de Thunderbird con la cuenta mruizgcompras@mruizg.es</em></p><h2 id="thunderbird-en-el-cliente"><span class="mr-2">Thunderbird en el cliente</span><a href="#thunderbird-en-el-cliente" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/tutorial-configurar-postfix/thunderbirdCliente1.png" alt="img-description" data-proofer-ignore> <em>Login en Thunderbird desde cliente con mruizventas@mruizg.es</em></p><p><img data-src="/assets/img/tutorial-configurar-postfix/thunderbirdCliente2.png" alt="img-description" data-proofer-ignore> <em>Advertencia de seguridad</em></p><p><img data-src="/assets/img/tutorial-configurar-postfix/thunderbirdCliente3.png" alt="img-description" data-proofer-ignore> <em>Inbox de Thunderbird con la cuenta mruizventas@mruizg.es</em></p><h2 id="prueba-de-funcionamiento"><span class="mr-2">Prueba de funcionamiento</span><a href="#prueba-de-funcionamiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/tutorial-configurar-postfix/pruebaFuncionamiento.png" alt="img-description" data-proofer-ignore> <em>Prueba de funcionamiento con Thunderbird</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/sistemas-microinform%C3%A1ticos-y-redes/'>Sistemas Microinformáticos y Redes</a>, <a href='/categories/servicios-en-red/'>Servicios en Red</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/servicios-en-red/" class="post-tag no-text-decoration" >servicios en red</a> <a href="/tags/smr/" class="post-tag no-text-decoration" >smr</a> <a href="/tags/tutorial/" class="post-tag no-text-decoration" >tutorial</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> Este artículo está licenciado bajo <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> por el autor.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Compartir</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Tutorial: Instalar y configurar servicio de email Postfix - Marcos Ruiz&amp;url=https://marcosruiz.github.io/posts/tutorial-configurar-postfix/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Tutorial: Instalar y configurar servicio de email Postfix - Marcos Ruiz&amp;u=https://marcosruiz.github.io/posts/tutorial-configurar-postfix/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://marcosruiz.github.io/posts/tutorial-configurar-postfix/&amp;text=Tutorial: Instalar y configurar servicio de email Postfix - Marcos Ruiz" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copiar link" data-title-succeed="Link copiado satisfactoriamente!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recientemente actualizado</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/tutorial-moodle-docker/">Tutorial: Instalar Moodle con Docker</a><li><a href="/posts/tutorial-nextcloud/">Tutorial: Monta tu propio Google Drive con NextCloud</a><li><a href="/posts/guias-estilo/">Guías de estilo</a><li><a href="/posts/callbacks-javascript/">Callbacks en JavaScript</a><li><a href="/posts/propagacion-eventos-javascript/">Propagación de eventos en JavaScript</a></ul></div><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/smr/">smr</a> <a class="post-tag" href="/tags/daw/">daw</a> <a class="post-tag" href="/tags/desarrollo-de-aplicaciones-web/">desarrollo de aplicaciones web</a> <a class="post-tag" href="/tags/teor%C3%ADa/">teoría</a> <a class="post-tag" href="/tags/ciclo-superior/">ciclo superior</a> <a class="post-tag" href="/tags/fp/">fp</a> <a class="post-tag" href="/tags/modulo/">modulo</a> <a class="post-tag" href="/tags/pr%C3%A1ctica/">práctica</a> <a class="post-tag" href="/tags/formaci%C3%B3n-profesional/">formación profesional</a> <a class="post-tag" href="/tags/seguridad-inform%C3%A1tica/">seguridad informática</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Índice</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Otros artículos</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/instalar-zorin-lite-os/"><div class="card-body"> <em class="timeago small" data-ts="1641564000" > 2022-01-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Instalar Zorin OS Lite en Virtual Box</h3><div class="text-muted small"><p> Objetivo El objetivo de este documento es instalar y realizar la configuración inicial de una máquina virtual Zorin OS para la realización del resto de prácticas, de modo que todos los alumnos ten...</p></div></div></a></div><div class="card"> <a href="/posts/practica-proftpd-1/"><div class="card-body"> <em class="timeago small" data-ts="1641762000" > 2022-01-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Práctica: Servicio FTP (Parte 1)</h3><div class="text-muted small"><p> Objetivo El objetivo de esta práctica es: Conocer el funcionamiento del protocolo de transferencia de archivos. Entender el modo de funcionamiento cliente-servidor. Ser capaz de gestionar ...</p></div></div></a></div><div class="card"> <a href="/posts/practica-proftpd-2/"><div class="card-body"> <em class="timeago small" data-ts="1641763800" > 2022-01-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Práctica: Servicio FTP (Parte 2)</h3><div class="text-muted small"><p> Objetivo El objetivo de esta práctica es: Conocer el sistema de permisos de GNU Linux. Conocer el funcionamiento del UMask del servidor ProFTPD. Duración: 1,5 horas. Actividades A contin...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/redes-mixtas-integradas/" class="btn btn-outline-primary" prompt="Más viejo"><p>Redes mixtas integradas</p></a> <a href="/posts/practica-enrutamiento-con-packet-tracer/" class="btn btn-outline-primary" prompt="Más nuevo"><p>Práctica: Subredes con enrutamiento en Packet Tracer</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "marcosruiz/marcosruiz.github.io", "data-repo-id": "R_kgDOGm1dzA", "data-category": "General", "data-category-id": "DIC_kwDOGm1dzM4CAjhb", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "es", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/marcosruiz">Marcos Ruiz</a>. <span data-toggle="tooltip" data-placement="top" title="Excepto donde si indique lo contrario, los artículos de este blog están licenciados bajo Creative Commons Attribution 4.0 International (CC BY 4.0) Licenciado por el autor.">Algunos derechos reservados.</span></p></div><div class="footer-right"><p class="mb-0"> Desarrollado por <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> con el tema <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> .</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Etiquetas populares</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/smr/">smr</a> <a class="post-tag" href="/tags/daw/">daw</a> <a class="post-tag" href="/tags/desarrollo-de-aplicaciones-web/">desarrollo de aplicaciones web</a> <a class="post-tag" href="/tags/teor%C3%ADa/">teoría</a> <a class="post-tag" href="/tags/ciclo-superior/">ciclo superior</a> <a class="post-tag" href="/tags/fp/">fp</a> <a class="post-tag" href="/tags/modulo/">modulo</a> <a class="post-tag" href="/tags/pr%C3%A1ctica/">práctica</a> <a class="post-tag" href="/tags/formaci%C3%B3n-profesional/">formación profesional</a> <a class="post-tag" href="/tags/seguridad-inform%C3%A1tica/">seguridad informática</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! Resultado no encontrado.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/es.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GS5HW4NZ8V"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GS5HW4NZ8V'); }); </script>
